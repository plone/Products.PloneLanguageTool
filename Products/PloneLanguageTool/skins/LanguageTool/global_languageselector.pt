<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      i18n:domain="plone">

<body>

<!-- LANGUAGE SWITCHER DEFINITION -->

<div metal:define-macro="language"
     tal:define="served_languages here/portal_languages/listSupportedLanguages;
                 boundLanguages here/portal_languages/getLanguageBindings;
                 prefLang python:boundLanguages[0];"
     tal:omit-tag="">

    <ul tal:condition="python:len(served_languages) >= 2">
        <li tal:repeat="lang served_languages"
            tal:condition="here/portal_languages/showFlags">

            <span tal:omit-tag="python:prefLang != lang[0]"
                  tal:define="code python:lang[0]">

                <a href=""
                   tal:define="flag python: here.portal_languages.getFlagForLanguageCode(code)"
                   tal:attributes="href string:${here/absolute_url}/switchLanguage?set_language=${code};
                                   title python:here.portal_languages.getNameForLanguageCode(lang[0]) or lang[1]">
                    <tal:flag condition="flag">
                        <img width="14"
                             height="11"
                             alt=""
                             tal:attributes="src string:${portal_url}/${flag};
                                             title python: lang[1];
                                             class python: test(prefLang == lang[0], 'currentItem', None);" />
                    </tal:flag>
                    <tal:nonflag condition="not: flag">
                        <span tal:replace="code">language code</span>
                    </tal:nonflag>
                </a>
            </span>
        </li>

        <li tal:condition="not: here/portal_languages/showFlags">
            <select style="font-size: 94%;"
                    onchange=""
                    tal:attributes="onchange string:window.location='${here/absolute_url}/switchLanguage?set_language=' + this.options(this.selectedIndex).value">
                <option tal:repeat="lang served_languages"
                        tal:content="python:here.portal_languages.getNameForLanguageCode(lang[0]) or lang[1]"
                        tal:attributes="selected python:prefLang == lang[0];
                                        value python:lang[0]">Language</option>
            </select>
        </li>
    </ul>
</div>

</body>
</html>
